!function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function e(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}c((i=i.apply(e,t||[])).next())}))}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function t(e,t,n,i){return new(n||(n=Promise))((function(o,s){function a(e){try{c(i.next(e))}catch(e){s(e)}}function r(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}c((i=i.apply(e,t||[])).next())}))}class n{constructor(e){this.nativeRecognizerRunner=e}processImage(e){const t=this.nativeRecognizerRunner.processImage(e);return Promise.resolve(t)}reconfigureRecognizers(e,t){return new Promise((n,i)=>{try{this.nativeRecognizerRunner.reconfigureRecognizers(e,t),n()}catch(e){i(e)}})}setMetadataCallbacks(e){return this.nativeRecognizerRunner.setJSDelegate(e),Promise.resolve()}resetRecognizers(e){return this.nativeRecognizerRunner.resetRecognizers(e),Promise.resolve()}setDetectionOnlyMode(e){return this.nativeRecognizerRunner.setDetectionOnlyMode(e),Promise.resolve()}setClearTimeoutCallback(e){return this.nativeRecognizerRunner.setClearTimeoutCallback(e),Promise.resolve()}setCameraPreviewMirrored(e){return this.nativeRecognizerRunner.setCameraPreviewMirrored(e),Promise.resolve()}delete(){return this.nativeRecognizerRunner.delete(),this.nativeRecognizerRunner=null,Promise.resolve()}}class i{constructor(e){this.realWasmModule=e}newRecognizer(e,...t){const n=new this.realWasmModule[e](...t);return n.recognizerName=e,Promise.resolve(n)}createRecognizerRunner(e,t=!1,i={}){const o=new this.realWasmModule.RecognizerRunner(e,t,i);return Promise.resolve(new n(o))}}class o{constructor(e){this.mbWasmModule=new i(e)}}let s=0;class a{constructor(e){this.action=e,this.messageID=function(){const e=s;return s+=1,e}()}}class r extends a{constructor(e,t){super(r.action),this.wasmModuleName=e.wasmModuleName,this.licenseKey=e.licenseKey,this.userId=t,this.registerLoadCallback=null!=e.loadProgressCallback}}var c,l,d,u,h;r.action="init",function(e){e[e.Any=0]="Any",e[e.Recognizer=1]="Recognizer"}(c||(c={}));class m extends a{constructor(e,t){super(m.action),this.className=e,this.params=t}}m.action="createNewNativeObject";class g extends a{constructor(e,t,n){super(g.action),this.recognizerHandles=e,this.allowMultipleResults=t,this.registeredMetadataCallbacks=n}}g.action="createRecognizerRunner";class R extends a{constructor(e,t){super(R.action),this.recognizerHandles=e,this.allowMultipleResults=t}}R.action="reconfigureRecognizerRunner";class b extends a{constructor(){super(b.action)}}b.action="deleteRecognizerRunner";class v extends a{constructor(e,t,n){super(v.action),this.objectHandle=e,this.methodName=t,this.params=n}}v.action="invokeObject";class w extends a{constructor(e){super(w.action),this.frame=e}getTransferrables(){return[this.frame.imageData.data.buffer]}}w.action="processImage";class D extends a{constructor(e){super(D.action),this.hardReset=e}}D.action="resetRecognizers";class f{constructor(){this.onDebugText=!1,this.onDetectionFailed=!1,this.onQuadDetection=!1,this.onPointsDetection=!1,this.onFirstSideResult=!1,this.onGlare=!1}}class p extends a{constructor(e){super(p.action),this.registeredMetadataCallbacks=e}}p.action="registerMetadataCallbacks";class C extends a{constructor(e){super(C.action),this.detectionOnlyMode=e}}C.action="setDetectionOnly";class k extends a{constructor(e){super(k.action),this.callbackNonEmpty=e}}k.action="setClearTimeoutCallback";class y extends a{constructor(e){super(y.action),this.cameraPreviewMirrored=e}}function M(e,t){return n=>{const i=n;i.success?e():t(i.error)}}function T(e,t){return n=>{const i=n;i.success?e(n):t(i.error)}}y.action="setCameraPreviewMirrored",function(e){e[e.onDebugText=0]="onDebugText",e[e.onDetectionFailed=1]="onDetectionFailed",e[e.onQuadDetection=2]="onQuadDetection",e[e.onPointsDetection=3]="onPointsDetection",e[e.onFirstSideResult=4]="onFirstSideResult",e[e.clearTimeoutCallback=5]="clearTimeoutCallback",e[e.onGlare=6]="onGlare"}(l||(l={}));class P{constructor(e,t,n){this.wasmSDKWorker=e,this.objectHandle=n,this.recognizerName=t}getRemoteObjectHandle(){return this.objectHandle}currentSettings(){return this.objectHandle<0?Promise.reject("Invalid object handle: "+this.objectHandle):new Promise((e,t)=>{const n=new v(this.objectHandle,"currentSettings",[]),i=T(t=>{e(t.result)},t);this.wasmSDKWorker.postMessage(n,i)})}updateSettings(e){return this.objectHandle<0?Promise.reject("Invalid object handle: "+this.objectHandle):new Promise((t,n)=>{const i=new v(this.objectHandle,"updateSettings",[{parameter:e,type:c.Any}]),o=M(t,n);this.wasmSDKWorker.postMessage(i,o)})}getResult(){return this.objectHandle<0?Promise.reject("Invalid object handle: "+this.objectHandle):new Promise((e,t)=>{const n=new v(this.objectHandle,"getResult",[]),i=T(t=>{e(t.result)},t);this.wasmSDKWorker.postMessage(n,i)})}delete(){return this.objectHandle<0?Promise.reject("Invalid object handle: "+this.objectHandle):new Promise((e,t)=>{const n=new v(this.objectHandle,"delete",[]),i=M(()=>{this.objectHandle=-1,e()},t);this.wasmSDKWorker.postMessage(n,i)})}}function F(e){const t=new f;return t.onDebugText=!!e.onDebugText,t.onDetectionFailed=!!e.onDetectionFailed,t.onPointsDetection=!!e.onPointsDetection,t.onQuadDetection=!!e.onQuadDetection,t.onFirstSideResult=!!e.onFirstSideResult,t.onGlare=!!e.onGlare,t}class E{constructor(e){this.deleted=!1,this.wasmSDKWorker=e}processImage(e){return this.deleted?Promise.reject("Recognizer runner is deleted. It cannot be used anymore!"):new Promise((t,n)=>{const i=new w(e),o=T(e=>{const n=e.recognitionState;t(n)},n);this.wasmSDKWorker.postTransferrableMessage(i,o)})}reconfigureRecognizers(e,t){return this.deleted?Promise.reject("Recognizer runner is deleted. It cannot be used anymore!"):new Promise((n,i)=>{const o=S(e),s=new R(o,t),a=M(n,i);this.wasmSDKWorker.postMessage(s,a)})}setMetadataCallbacks(e){return new Promise((t,n)=>{const i=new p(F(e)),o=M(t,n);this.wasmSDKWorker.postMessageAndRegisterCallbacks(i,e,o)})}resetRecognizers(e){return new Promise((t,n)=>{const i=new D(e),o=M(t,n);this.wasmSDKWorker.postMessage(i,o)})}setDetectionOnlyMode(e){return new Promise((t,n)=>{const i=new C(e),o=M(t,n);this.wasmSDKWorker.postMessage(i,o)})}setClearTimeoutCallback(e){return new Promise((t,n)=>{const i=new k(null!=e),o=M(t,n);this.wasmSDKWorker.registerClearTimeoutCallback(e),this.wasmSDKWorker.postMessage(i,o)})}setCameraPreviewMirrored(e){return new Promise((t,n)=>{const i=new y(e),o=M(t,n);this.wasmSDKWorker.postMessage(i,o)})}delete(){return this.deleted?Promise.reject("Recognizer runner is already deleted."):new Promise((e,t)=>{const n=new b,i=M(()=>{this.deleted=!0,e()},t);this.wasmSDKWorker.postMessage(n,i)})}}function S(e){const t=[];for(let n in e){const i=e[n];t.push(i.getRemoteObjectHandle())}return t}class I{constructor(e){this.wasmSDKWorker=e}createRecognizerRunner(e,t=!1,n={}){return new Promise((i,o)=>{const s=S(e),a=new g(s,t,F(n)),r=M(()=>{i(new E(this.wasmSDKWorker))},o);this.wasmSDKWorker.postMessageAndRegisterCallbacks(a,n,r)})}newRecognizer(e,...t){return new Promise((n,i)=>{const o=new m(e,function(e){const t=[];for(let n in e){let i=e[n],o=c.Any;i instanceof P&&(o=c.Recognizer,i=i.getRemoteObjectHandle()),t.push({parameter:i,type:o})}return t}(t)),s=T(t=>{n(new P(this.wasmSDKWorker,e,t.objectHandle))},i);this.wasmSDKWorker.postMessage(o,s)})}}class A{constructor(e,t){this.eventHandlers={},this.metadataCallbacks={},this.clearTimeoutCallback=null,this.mbWasmWorker=e,this.mbWasmWorker.onmessage=e=>{this.handleWorkerEvent(e)},this.mbWasmModule=new I(this),this.loadCallback=t}postMessage(e,t){this.eventHandlers[e.messageID]=t,this.mbWasmWorker.postMessage(e)}postTransferrableMessage(e,t){this.eventHandlers[e.messageID]=t,this.mbWasmWorker.postMessage(e,e.getTransferrables())}postMessageAndRegisterCallbacks(e,t,n){this.eventHandlers[e.messageID]=n,this.metadataCallbacks=t,this.mbWasmWorker.postMessage(e)}registerClearTimeoutCallback(e){this.clearTimeoutCallback=e}handleWorkerEvent(e){if("isCallbackMessage"in e.data){const t=e.data;switch(t.callbackType){case l.onDebugText:this.metadataCallbacks.onDebugText(t.callbackParameters[0]);break;case l.onDetectionFailed:this.metadataCallbacks.onDetectionFailed();break;case l.onPointsDetection:this.metadataCallbacks.onPointsDetection(t.callbackParameters[0]);break;case l.onQuadDetection:this.metadataCallbacks.onQuadDetection(t.callbackParameters[0]);break;case l.onFirstSideResult:this.metadataCallbacks.onFirstSideResult();break;case l.clearTimeoutCallback:this.clearTimeoutCallback.onClearTimeout();break;case l.onGlare:this.metadataCallbacks.onGlare(t.callbackParameters[0]);break;default:throw new Error("Unknown callback type "+t.callbackType)}}else if("isLoadProgressMessage"in e.data){const t=e.data;this.loadCallback(t.progress)}else{const t=e.data,n=this.eventHandlers[t.messageID];delete this.eventHandlers[t.messageID],n(t)}}static createWasmWorker(e,n,i){return t(this,void 0,void 0,(function*(){return new Promise((t,o)=>{const s=new A(e,n.loadProgressCallback),a=new r(n,i),c=M(()=>{t(s)},o);s.postMessage(a,c)})}))}}let W;!function(e){e[e.RotatedLeft90=0]="RotatedLeft90",e[e.NoRotation=1]="NoRotation",e[e.RotatedRight90=2]="RotatedRight90",e[e.Rotated180=3]="Rotated180"}(d||(d={})),function(e){e[e.Empty=0]="Empty",e[e.Uncertain=1]="Uncertain",e[e.Valid=2]="Valid"}(u||(u={})),function(e){e[e.Fail=0]="Fail",e[e.Success=1]="Success",e[e.CameraTooHigh=2]="CameraTooHigh",e[e.FallbackSuccess=3]="FallbackSuccess",e[e.Partial=4]="Partial",e[e.CameraAtAngle=5]="CameraAtAngle",e[e.CameraTooNear=6]="CameraTooNear",e[e.DocumentTooCloseToEdge=7]="DocumentTooCloseToEdge"}(h||(h={}));class z{constructor(e,t,n){this.imageData=e,this.orientation=t,this.videoFrame=n}}var N,H,O;!function(e){e[e.BackFacingCamera=0]="BackFacingCamera",e[e.FrontFacingCamera=1]="FrontFacingCamera"}(N||(N={})),function(e){e.MediaDevicesNotSupported="MediaDevicesNotSupported",e.CameraNotFound="CameraNotFound",e.CameraNotAllowed="CameraNotAllowed",e.CameraInUse="CameraInUse",e.CameraNotAvailable="CameraNotAvailable"}(H||(H={}));class x extends Error{constructor(e,...t){super(...t),this.reason=e,this.name="VideoRecognizerError"}}!function(e){e[e.Recognition=0]="Recognition",e[e.RecognitionTest=1]="RecognitionTest",e[e.DetectionTest=2]="DetectionTest"}(O||(O={}));class _{constructor(e,t){this.videoFeed=null,this.cancelled=!1,this.timedOut=!1,this.recognitionPaused=!1,this.recognitionTimeoutMs=3e4,this.timeoutID=0,this.videoRecognitionMode=O.Recognition,this.onScanningDone=null,this.videoFeed=e,this.recognizerRunner=t}static createVideoRecognizerFromCameraStream(e,n,i=N.BackFacingCamera){return t(this,void 0,void 0,(function*(){return new Promise((o,s)=>t(this,void 0,void 0,(function*(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{const a=yield function(e){return t(this,void 0,void 0,(function*(){let t=[],n=[];{let e=yield navigator.mediaDevices.enumerateDevices();if(e.filter(e=>"videoinput"===e.kind).every(e=>""===e.label)){const t=yield navigator.mediaDevices.getUserMedia({video:{facingMode:{ideal:"environment"}},audio:!1});e=yield navigator.mediaDevices.enumerateDevices(),t.getTracks().forEach(e=>e.stop())}const i=e.filter(e=>"videoinput"===e.kind);for(let e in i){const o=i[e];K(o.label)?n.push(new B(o,N.BackFacingCamera)):t.push(new B(o,N.FrontFacingCamera))}}if(t.length>0||n.length>0){let i=n.length>0?n:t;e===N.BackFacingCamera&&n.length>0&&(i=n),e===N.FrontFacingCamera&&t.length>0&&(i=t),i=i.sort((e,t)=>e.label.localeCompare(t.label));{let e=0;const t=i.map(e=>{const t=e.label.match(/\b([0-9]+)MP?\b/i);return null!=t?parseInt(t[1],10):NaN});return t.some(e=>isNaN(e))||(e=t.lastIndexOf(Math.max(...t))),i[e]}}return null}))}(i);if(null==a)return void s(new x(H.CameraNotFound));const r={audio:!1,video:{width:{min:640,ideal:1920,max:1920},height:{min:480,ideal:1080,max:1080}}};""===a.deviceId?r.video.facingMode={ideal:i===N.BackFacingCamera?"environment":"user"}:r.video.deviceId={exact:a.deviceId};const c=yield navigator.mediaDevices.getUserMedia(r);e.controls=!1,e.srcObject=c,a.facing==N.FrontFacingCamera&&(e.style.transform="scaleX(-1)"),yield n.setCameraPreviewMirrored(a.facing==N.FrontFacingCamera),o(new _(e,n))}catch(e){let t=H.CameraInUse;switch(e.name){case"NotFoundError":case"OverconstrainedError":t=H.CameraNotFound;break;case"NotAllowedError":case"SecurityError":t=H.CameraNotAllowed;break;case"AbortError":case"NotReadableError":t=H.CameraNotAvailable;break;case"TypeError":throw e}s(new x(t,e.message))}else s(new x(H.MediaDevicesNotSupported))})))}))}static createVideoRecognizerFromVideoPath(e,n,i){return t(this,void 0,void 0,(function*(){return new Promise(t=>{n.src=e,n.currentTime=0,n.onended=()=>{o.cancelRecognition()};const o=new _(n,i);t(o)})}))}setVideoRecognitionMode(e){return t(this,void 0,void 0,(function*(){this.videoRecognitionMode=e,yield this.recognizerRunner.setDetectionOnlyMode(this.videoRecognitionMode===O.DetectionTest)}))}startRecognition(e,t=3e4){if(null==this.videoFeed)throw new Error("The associated video feed has been released!");if(!this.videoFeed.paused)throw new Error("The associated video feed is not paused. Use resumeRecognition instead!");this.cancelled=!1,this.recognitionPaused=!1,this.clearTimeout(),this.recognitionTimeoutMs=t,this.onScanningDone=e,this.recognizerRunner.setClearTimeoutCallback({onClearTimeout:()=>this.clearTimeout()}),this.videoFeed.play().then(()=>this.playPauseEvent(),()=>{alert("Auto-play prevented by browser security rules! Please start video manually!"),this.videoFeed.controls=!0,this.videoFeed.addEventListener("play",()=>this.playPauseEvent()),this.videoFeed.addEventListener("pause",()=>this.playPauseEvent())})}recognize(e=3e4){return t(this,void 0,void 0,(function*(){return new Promise((t,n)=>{try{this.startRecognition(e=>{this.pauseVideoFeed(),t(e)},e)}catch(e){n(e)}})}))}cancelRecognition(){this.cancelled=!0}pauseVideoFeed(){this.pauseRecognition(),this.videoFeed.pause()}pauseRecognition(){this.recognitionPaused=!0}resetRecognizers(e){return t(this,void 0,void 0,(function*(){yield this.recognizerRunner.resetRecognizers(e)}))}getRecognizerRunner(){return this.recognizerRunner}resumeRecognition(e){if(this.cancelled=!1,this.timedOut=!1,this.recognitionPaused=!1,this.videoFeed.paused)throw new Error("Cannot resume recognition while video feed is paused! You need to use recognize or startRecognition");setTimeout(()=>t(this,void 0,void 0,(function*(){e&&(yield this.resetRecognizers(!0)),this.recognitionLoop()})),1)}releaseVideoFeed(){null!=this.videoFeed&&(null!=this.videoFeed.srcObject&&(this.videoFeed.paused||this.cancelRecognition(),this.videoFeed.srcObject.getTracks().forEach(e=>e.stop()),this.videoFeed.srcObject=null),this.videoFeed=null)}playPauseEvent(){this.videoFeed.paused?this.cancelRecognition():this.resumeRecognition(!0)}recognitionLoop(){return t(this,void 0,void 0,(function*(){const e=function(e){let t,n,i=!1;if(e instanceof HTMLVideoElement)t=e.videoWidth,n=e.videoHeight,i=!0;else if(e instanceof HTMLImageElement)t=e.naturalWidth,n=e.naturalHeight;else{if(e instanceof SVGImageElement)throw new Error("Recognition of SVG elements not supported!");t=e.width,n=e.height}W=W||document.createElement("canvas"),W.width=t,W.height=n;const o=W.getContext("2d");o.drawImage(e,0,0,W.width,W.height);let s=o.getImageData(0,0,W.width,W.height);return new z(s,d.NoRotation,i)}(this.videoFeed),t=yield this.recognizerRunner.processImage(e);t==u.Valid||this.cancelled||this.timedOut?this.videoRecognitionMode==O.Recognition||this.cancelled?(this.clearTimeout(),this.onScanningDone(t)):(yield this.recognizerRunner.resetRecognizers(!0),this.clearTimeout()):t!=u.Empty&&0==this.timeoutID&&(this.timeoutID=window.setTimeout(()=>{this.timedOut=!0},this.recognitionTimeoutMs)),this.recognitionPaused||setTimeout(()=>{this.recognitionLoop()},1)}))}clearTimeout(){this.timeoutID>0&&(window.clearTimeout(this.timeoutID),this.timeoutID=0)}}const j=["rear","back","rück","arrière","trasera","trás","traseira","posteriore","后面","後面","背面","后置","後置","背置","задней","الخلفية","후","arka","achterzijde","หลัง","baksidan","bagside","sau","bak","tylny","takakamera","belakang","אחורית","πίσω","spate","hátsó","zadní","darrere","zadná","задня","stražnja","belakang","बैक"];function K(e){const t=e.toLowerCase();return j.some(e=>t.includes(e))}class B{constructor(e,t){this.deviceId=e.deviceId,this.facing=t,this.groupId=e.groupId,this.label=e.label}}class Y{constructor(e){this.useWebWorker=!0,this.wasmModuleName="BlinkIDWasmSDK",this.loadProgressCallback=null,this.licenseKey=e}}function V(){let e=localStorage.getItem("mb-user-id");return null==e&&(e=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),localStorage.setItem("mb-user-id",e)),e}var L,U,G;!function(e){e[e.NONE=0]="NONE",e[e.QR_CODE=1]="QR_CODE",e[e.DATA_MATRIX=2]="DATA_MATRIX",e[e.UPC_E=3]="UPC_E",e[e.UPC_A=4]="UPC_A",e[e.EAN_8=5]="EAN_8",e[e.EAN_13=6]="EAN_13",e[e.CODE_128=7]="CODE_128",e[e.CODE_39=8]="CODE_39",e[e.ITF=9]="ITF",e[e.AZTEC_BARCODE=10]="AZTEC_BARCODE",e[e.PDF417_BARCODE=11]="PDF417_BARCODE"}(L||(L={})),function(e){e[e.None=0]="None",e[e.AAMVACompliant=1]="AAMVACompliant",e[e.ArgentinaID=2]="ArgentinaID",e[e.ArgentinaDL=3]="ArgentinaDL",e[e.ColombiaID=4]="ColombiaID",e[e.ColombiaDL=5]="ColombiaDL",e[e.NigeriaVoterID=6]="NigeriaVoterID",e[e.NigeriaDL=7]="NigeriaDL",e[e.PanamaID=8]="PanamaID",e[e.SouthAfricaID=9]="SouthAfricaID"}(U||(U={})),function(e){e[e.MRTD_TYPE_UNKNOWN=0]="MRTD_TYPE_UNKNOWN",e[e.MRTD_TYPE_IDENITY_CARD=1]="MRTD_TYPE_IDENITY_CARD",e[e.MRTD_TYPE_PASSPORT=2]="MRTD_TYPE_PASSPORT",e[e.MRTD_TYPE_VISA=3]="MRTD_TYPE_VISA",e[e.MRTD_TYPE_GREEN_CARD=4]="MRTD_TYPE_GREEN_CARD",e[e.MRTD_TYPE_MYS_PASS_IMM13P=5]="MRTD_TYPE_MYS_PASS_IMM13P"}(G||(G={}));const Q=document.getElementById("loadingScreen"),q=document.getElementById("loadProgress");if(function(){try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){const e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(e instanceof WebAssembly.Module)return new WebAssembly.Instance(e)instanceof WebAssembly.Instance}}catch(e){}return!1}()){const e=new Y(function(){if("localhost"==window.location.hostname)return"sRwAAAYJbG9jYWxob3N0r/lOPig/w35CpJnWKlq+ZJzK3xccLSIruDSb18DHmilDcTBqO8JYgpsBzoirfhucxge8mE9wKDIMLG3GeVOJn1Qm/IMDjREWfwQKIleuJxnFSDflBbooYUnf/zNDuoQgDXAoscf+qBbbEt6yC17HVB17UZBT/fRgEDym6D9fDTHVJOkUs2Ai1ZNsNAYQBMQx0pE3zxV4FO7YUGedd3nKdURvFKbOs002Cnev+G4Kqge7Gy+F3eIjRJHdEw+/pFO5i1/U+7pMLzSneyVWgijA";if("blinkid.github.io"==window.location.hostname)return"sRwAAAYRYmxpbmtpZC5naXRodWIuaW+qBF9hW4YlTvZbRuaFVwbiD8KZM6KyFj+Gxuno9ppVrGWjCzH3zaPlD0Rrt/nEJcExVA8saYUOqtODKxAki0rsatzpBjyHuWpAGQeoi49aIwCqsNGA9H8Em/IbR5sBgIu0bR94Oi/mfL0eG9F76UgX2T8cTiRGHdqE+b4u+qYvTwy5lAOESIWjb3fCYdHip9KmPxp9KHvS5veYCHYWKHH6cqXvSuhhM/JtXTdFW1UZ3VcF05Nfjx2Rp5ck+LHB9B/2vlNafX8qq6WM7UcoMc8=";throw new Error("No license key for "+window.location.hostname)}());e.loadProgressCallback=e=>{q.value=e},function(e){return t(this,void 0,void 0,(function*(){return new Promise((n,i)=>t(this,void 0,void 0,(function*(){if(null===e.licenseKey||void 0===e.licenseKey)return void i("Missing license key!");if(!e.wasmModuleName)return void i("Missing WASM module name!");const t=V();if(e.useWebWorker)try{const i=yield A.createWasmWorker(new Worker("./MicroblinkSDK.worker.js"),e,t);n(i)}catch(e){i(e)}else{const s=self[e.wasmModuleName];let a=void 0;null!=e.loadProgressCallback&&(a={setStatus:t=>{e.loadProgressCallback(function(e){if("Running..."==e)return 100;if(0==e.length)return 0;const t=e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/);if(t){return 100*parseInt(t[2])/parseInt(t[4])}return console.debug("Cannot parse emscripten status: ",e),NaN}(t))}}),s(a).then(s=>{try{return s.initializeWithLicenseKey(e.licenseKey,t),void n(new o(s))}catch(e){return void i(e)}},e=>{console.log("Failed to load WASM. Reason: "+e),i(e)})}})))}))}(e).then(e=>{console.log("WASM loaded successfully!"),Q.hidden=!0,document.getElementById("btnStart").hidden=!1;const t=new J(e);window.app=t},e=>{console.error("Failed to load WASM! Reason: "+e),alert("Failed to load WASM! Reason: "+e),Q.innerHTML="<h1>Failed to load WASM! Reason: "+e+"</h1>"})}else Q.innerHTML="<h1>Your browser is not supported by this SDK! <h1/>";class J{constructor(e){this.wasmSDK=e,this.detectionResult=document.getElementById("cameraFeedback"),this.cameraFeed=document.getElementById("cameraFeed"),this.drawContext=this.detectionResult.getContext("2d")}startScanning(){return e(this,void 0,void 0,(function*(){const e=yield function(e){return t(this,void 0,void 0,(function*(){return e.mbWasmModule.newRecognizer("MrtdRecognizer")}))}(this.wasmSDK),n=yield function(e){return t(this,void 0,void 0,(function*(){return e.mbWasmModule.newRecognizer("IdBarcodeRecognizer")}))}(this.wasmSDK),i={onQuadDetection:e=>{this.drawQuad(e)}},o=yield function(e,n,i=!1,o={}){return t(this,void 0,void 0,(function*(){return e.mbWasmModule.createRecognizerRunner(n,i,o)}))}(this.wasmSDK,[e,n],!1,i),s=yield _.createVideoRecognizerFromCameraStream(this.cameraFeed,o);if(document.getElementById("btnStart").hidden=!0,document.getElementById("cameraMessage").hidden=!1,(yield s.recognize())!=u.Empty){let t="";const i=yield e.getResult();i.state!=u.Empty&&(console.log(i),t+="Hello, "+i.mrzResult.secondaryID+" "+i.mrzResult.primaryID+"! You were born on "+i.mrzResult.dateOfBirth.year+"-"+i.mrzResult.dateOfBirth.month+"-"+i.mrzResult.dateOfBirth.day+"!\n");const o=yield n.getResult();o.state!=u.Empty&&(console.log(o),t+="Hello, "+o.firstName+" "+o.lastName+"! You were born on "+o.dateOfBirth.year+"-"+o.dateOfBirth.month+"-"+o.dateOfBirth.day+"!\n"),0!=t.length&&alert(t)}s.releaseVideoFeed(),o.delete(),e.delete(),n.delete(),document.getElementById("btnStart").hidden=!1,document.getElementById("cameraMessage").hidden=!0,this.clearDrawCanvas()}))}drawQuad(e){this.clearDrawCanvas(),this.setupColor(e);const t=this.drawContext;this.applyTransform(t,e.transformMatrix),t.beginPath(),t.moveTo(e.topLeft.x,e.topLeft.y),t.lineTo(e.topRight.x,e.topRight.y),t.lineTo(e.bottomRight.x,e.bottomRight.y),t.lineTo(e.bottomLeft.x,e.bottomLeft.y),t.closePath(),t.stroke()}applyTransform(e,t){const n=this.detectionResult.width/this.detectionResult.height,i=this.cameraFeed.videoWidth/this.cameraFeed.videoHeight;let o=0,s=0,a=0,r=0;n>i?(a=this.detectionResult.height,r=i*a,o=(this.detectionResult.width-r)/2):(r=this.detectionResult.width,a=r/i,s=(this.detectionResult.height-a)/2),e.translate(o,s),e.scale(r/this.cameraFeed.videoWidth,a/this.cameraFeed.videoHeight),e.transform(t[0],t[3],t[1],t[4],t[2],t[5])}clearDrawCanvas(){this.detectionResult.width=this.detectionResult.clientWidth,this.detectionResult.height=this.detectionResult.clientHeight,this.drawContext.clearRect(0,0,this.detectionResult.width,this.detectionResult.height)}setupColor(e){const t=this.drawContext;let n="#FFFF00FF";e.detectionStatus==h.Fail?n="#FF0000FF":e.detectionStatus==h.Success&&(n="#00FF00FF"),t.fillStyle=n,t.strokeStyle=n,t.lineWidth=5}}}();
//# sourceMappingURL=index.js.map
